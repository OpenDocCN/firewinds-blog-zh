<html>
<head>
<title>Fairwinds Insights: CI Pipeline to Protect Your Kubernetes Clusters</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Fairwinds Insights: CI渠道保护您的Kubernetes集群</h1>
<blockquote>原文：<a href="https://www.fairwinds.com/blog/fairwinds-insights-continuous-integration-pipeline-to-protect-your-kubernetes-clusters#2022-12-08">https://www.fairwinds.com/blog/fairwinds-insights-continuous-integration-pipeline-to-protect-your-kubernetes-clusters#2022-12-08</a></blockquote><div><span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p>大约一年前，我们建造了<a href="https://www.fairwinds.com/insights"><span>fair winds Insights</span></a>来让我们的生活更轻松。我们管理着数十个组织的数百个集群，需要一种方法来跟踪这些集群在安全性、效率和可靠性方面的健康程度。因此，我们构建了一个平台来运行不同的Kubernetes审计工具，并将结果汇总到一个单一的仪表板中。</p>

<p>鸟瞰我们的集群的健康状况让我们——以及越来越多的客户——获得了自信地运行Kubernetes所需的可见性。每当有新的内容需要审计时，它就能够轻松地添加新的报告类型。</p>
<p>但是我们的客户很快指出，洞察力只能在错误发生后<em>捕捉错误！因为它只能分析正在运行的集群，所以它发现的任何问题都已经在影响生产。</em></p>
<p>理想情况下，我们应该能够在过程的早期发现这些问题，并阻止它们到达一个活动的集群。因此，我们建立了两种新的方式来运行Fairwinds Insights:持续集成管道，可以在同行评审期间发现<a href="https://www.fairwinds.com/blog/why-infrastructure-as-code-kubernetes"> <span>基础设施代码</span> </a>中的问题，以及准入控制器，可以防止有问题的资源进入集群。</p>
<h2><strong> Fairwinds对持续集成的见解</strong></h2>
<p>捕捉安全漏洞和其他问题的最佳时机是在同行评审中，在它们进入代码库的主要分支之前。当人们编辑Dockerfiles和Kubernetes清单时，他们可能会无意中安装易受攻击的软件，引入安全缺陷，或者忽略关键的配置部分，如资源请求或健康探测。</p>
<p>其中一些问题可以通过经验丰富的Kubernetes专家对代码的彻底检查来发现，但是这个过程可能会很繁琐并且容易出错。Fairwinds Insights的CI集成自动化了许多最重要的检查，以帮助评审人员快速发现问题。</p>
<p>可以对Insights进行配置，以便在引入新问题时显示警告，或者只要问题存在，就阻止开发人员合并他们的更改。</p>
<p><img src="../Images/2fbe40f69e7add5f471ca31512543331.png" alt="Screenshot of Fairwinds Insights checks unsuccessful or checks requiring statuses." data-original-src="https://lh5.googleusercontent.com/-hGLekDTA2l1sNhC_Ji75py_It_kuwV090p-ojRvps5QcjHOoJ6s69WbxOAnyNntQWOpPtBC1GvxPKPEst_70qVEhfsWwXSFAs2xvZSpODh5sQBGeejQkiKu54CKlC-Hby6U-jwX"/></p>
<p>当发现问题时，开发人员可以访问Fairwinds Insights，了解更多关于问题是什么，以及如何解决这些问题的信息:</p>
<p><img src="../Images/92e54fc1364c65b4fc95d933112112a0.png" alt="Screenshot of Fairwinds Insights of problem description and how to remediate." data-original-src="https://lh3.googleusercontent.com/YdOIscHVuei9snpl9lkNAfnNxsdpwLLylj1qCHHy1t65r-4nciUy86ir82wp88_OA8Y2VMzWkIIJetdtxXJRqXt3GvrhvVeJwNF5uL4m4pZQHUNewjOozrhQOUIaqPocX7esO4W9"/></p>
<p> </p>
<p>目前，Insights能够使用<a href="https://github.com/FairwindsOps/polaris" rel="noopener" target="_blank"> <span>北极星</span> </a>检查Kubernetes清单的配置问题，以及使用<a href="https://github.com/aquasecurity/trivy" rel="noopener" target="_blank"> <span> Trivy </span> </a>扫描已知CVE的Docker图像。在不久的将来，我们将添加对使用OPA  构建<a href="https://insights.docs.fairwinds.com/reports/opa/"> <span>自定义配置策略的支持，以及使用<a href="https://github.com/FairwindsOps/pluto" rel="noopener" target="_blank"> <span> Pluto </span> </a>检测废弃资源的支持。</span></a></p>
<p>当然，并不是集群中的每个资源都要经历一个CI过程——有些是由Kubernetes控制器自动创建的，有时工程师会使用kubectl和Helm手动创建或编辑资源。这就是为什么有一个准入控制器是重要的。</p>
<h2><strong>洞察准入控制器</strong></h2>
<p>理想情况下，集群中的一切都可以追溯到版本控制的<a href="https://www.fairwinds.com/blog/why-infrastructure-as-code-kubernetes"> <span>基础设施即代码</span> </a> (IaC)。利用IaC的团队可以更轻松地审计变更、回滚错误，并了解他们的集群中正在运行什么。</p>
<p>但是总有办法让东西不经过IaC审查就进入你的集群。有时你需要热修复，或者一个工程师不小心在错误的上下文中运行了<span> kubectl apply </span>。因此，除了CI检查之外，有一个后备机制来防止安全性、效率和可靠性问题进入您的集群也是至关重要的。准入控制器是这里的Kubernetes-native解决方案。</p>
<p>每当有新资源添加到集群中时，Fairwinds Insights准入控制器就会运行。如果资源违反了您组织的策略，准入控制器将拒绝它，并通知客户端(通常是运行kubectl或helm的开发人员)他们需要更改什么。</p>
<p><img src="../Images/cd1f9341f900d9af079e0e575a903d72.png" alt="Example of cat bad-deploy.yaml screenshot" data-original-src="https://lh3.googleusercontent.com/piT8Ya2tmOHwwLA9t6YDSKjMaY7McK4yzkIz0083csfBdb0Fnpa7RjcotOWtLhQao_7jY-ZtLmySzbT4pzhCSMdiOH1Esc_H9Ah0tgFWTpwM6Tos72ixUkRwImQp1m_YMFScYGEF"/></p>
<p>Fairwinds Insights允许您从一个集中的位置控制每个集群中的准入控制器。如果您想实施一个新的策略，或者创建一个豁免，您只需要接触一个系统，您的更改就会自动联合到各处。您还可以为某些集群配置独特的策略，例如，如果您希望在生产和转移方面更加严格。</p>
<h2><strong>左移</strong></h2>
<p>当然，Fairwinds Insights仍然出色地扫描了Kubernetes集群中当前运行的所有内容，以发现存在的问题，这将始终是您的基础架构有多安全、高效和可靠的最真实的视图。但是，通过将问题转移到CI管道和准入控制中，我们能够在问题进入集群之前预防问题。</p>
<blockquote>
<p>您可以永远免费使用Fairwinds Insights。拿过来<a href="/coming-soon" rel="noopener">这里</a>。</p>
</blockquote>
<p>此外，Fairwinds Insights能够在您的机群中的每个集群上应用从CI到准入到生产的相同策略(或它们的变体)。这样，每个人都遵循相同的标准，并且这些标准在整个开发周期中被一致地应用。</p>
<p>借助新的CI和准入控制器功能，运营团队可以高枕无忧，因为他们知道一旦他们的集群进入良好状态，Fairwinds Insights将确保他们保持这种状态。</p>
<h2><strong>资源</strong></h2>

<p><span class="hs-cta-wrapper" id="hs-cta-wrapper-d83db0e5-9dba-4c27-a19a-f0872a030500"><span class="hs-cta-node hs-cta-d83db0e5-9dba-4c27-a19a-f0872a030500" id="hs-cta-d83db0e5-9dba-4c27-a19a-f0872a030500"><a href="https://cta-redirect.hubspot.com/cta/redirect/2184645/d83db0e5-9dba-4c27-a19a-f0872a030500"><img class="hs-cta-img" id="hs-cta-img-d83db0e5-9dba-4c27-a19a-f0872a030500" src="../Images/3f878a33bc4aeb315050877041d679ae.png" alt="Kubernetes Policy Enforcement Fairwinds Insights" data-original-src="https://no-cache.hubspot.com/cta/default/2184645/d83db0e5-9dba-4c27-a19a-f0872a030500.png"/></a></span>T6】</span></p>
<p> </p></span></div>    
</body>
</html>