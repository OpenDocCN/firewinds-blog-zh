<html>
<head>
<title>Spotlight on Karpenter, Goldilocks and Cluster Autoscaling with Open Source</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>聚焦Karpenter、Goldilocks和开源集群自动扩展</h1>
<blockquote>原文：<a href="https://www.fairwinds.com/blog/spotlight-on-goldilocks-karpenter-and-autoscaling-with-open-source#2022-12-05">https://www.fairwinds.com/blog/spotlight-on-goldilocks-karpenter-and-autoscaling-with-open-source#2022-12-05</a></blockquote><div><span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p>在Fairwinds，我们致力于增强我们的开源社区。通过我们自己的工具，我们努力工作来回馈这个有价值的群体，为容器化的未来构建高质量的开源项目。在开放的环境中进行精心的组装也使我们能够与Kubernetes社区中的人们进行交流，从业余爱好者到企业，从而使工具更加强大、可靠和功能丰富。因此，这种开源软件使我们的客户和社区能够在Kubernetes生命周期的每个阶段做出更好的决策。</p>

<p>即便如此，在Kubernetes采用和实施的道路上，某些挑战仍然存在，包括需要“恰到好处地”获得资源请求和限制，在利用集群自动伸缩的集群中提供稳定性和效率。</p>
<h2>定义的聚类自动缩放</h2>
<p>使用Kubernetes的好处之一是能够根据用户需求动态扩展基础设施。集群自动缩放是一个增加或减少Kubernetes集群大小的组件。这是通过添加或删除工作节点来实现的，具体取决于挂起pod的存在。迄今为止，Kubernetes中最常用的自动缩放器是<a href="https://github.com/kubernetes/autoscaler" rel="noopener" target="_blank"> <span> Kubernetes集群自动缩放器</span> </a>。</p>
<p>如果您有太多的资源，集群自动缩放器(CA)可以删除工作节点并节省资金。根据您的组织需求，将您的集群规模降至零也是可能的。CA是一个行业采用的、开源的、厂商中立的工具。它是Kubernetes项目的一部分，由大多数主要的Kubernetes云提供商实施。最近，Karpenter项目进入了这个领域，其目标是解决集群自动缩放器的一些限制。</p>
<p>在考虑CA和Karpenter之间的区别之前，了解一下弹性Kubernetes服务(EKS)是很重要的，这是亚马逊在AWS云中对Kubernetes的实现。集群由一个“控制平面”和一组称为节点的机器组成。在EKS中创建集群时，会创建一个控制平面和一个自动扩展组。自动缩放组中的EC2实例使用预定义的映像，启动脚本将实例加入集群。最近几个月，AWS还引入了托管节点组的概念，AWS将自动管理自动扩展组。</p>
<h2>见见卡本特</h2>
<p>寻找有效自动缩放的人们将很快有更多的工作要做。Karpenter是一款开源软件，现在已经获得了Apache License 2.0的许可。作为设计用于在AWS中运行的Kubernetes集群的软件，Karpenter观察未调度pod的聚合资源请求，并做出启动和终止节点的决策，以最大限度地减少调度延迟和基础设施成本。</p>
<p>Karpenter在合适的时间用合适的节点简化了Kubernetes的基础设施。作为一种能力，这种“适用于任何Kubernetes集群的即时节点”是有价值的，因为它启动了理想的计算资源来处理集群的应用程序。通过这种方式，Karpenter旨在让您通过快速简单的K8s集群计算资源调配来充分利用云。卡本特也:</p>
<p><em>通过快速、自动地响应应用程序负载、时间安排和资源需求的变化，提高应用程序可用性</em>。这种能力将新的工作负载置于各种可用的计算资源上。</p>
<p><em>最大限度地减少运营开销</em>在单个声明式供应器资源中提供一组自以为是的默认值，可轻松定制；不需要额外的配置！</p>
<p>在集群中安装Karpenter后，可以观察Kubernetes集群中的事件，并将命令发送到底层云提供商的计算机服务，如Amazon EC2。这意味着Karpenter可以观察未调度pod的聚合资源请求，并启动新节点(或终止它们)以减少调度延迟和基础架构成本。</p>
<p>Karpenter的一个主要区别是它能够直接对EC2进行api调用。Karpenter可以做出所有最优的EC2实例选择来满足所有常量，而不是利用需要一组预定义实例类型的自动缩放组。只需60秒就可以配置一个新节点。如果您删除了一个节点，Karpenter会很好地处理所有的节点退役，包括封锁和清空节点以及关闭相应的实例。</p>
<p><a href="https://www.youtube.com/watch?v=3QsVRHVdOnM" rel="noopener" target="_blank"> <span>还在迷茫？看看这个关于Karpenter如何工作的高度可视化的解释！</span>T3】</a></p>
<h2>让金发女孩“恰到好处”</h2>
<p>当使用像Karpenter这样的自动缩放器时，获得正确的资源请求和限制变得更加重要。如果您的请求太高，Karpenter autoscaler可能会添加远远超过您在集群中实际需要的节点，这将导致更高的成本。如果它们太低，那么您可能会在较小的节点上遇到资源争用问题。</p>
<p>Goldilocks为调整您的资源请求和限制提供了一个解决方案。作为我们在Fairwinds Insights中用来优化Kubernetes工作负载的开源项目，Goldilocks消除了对Kubernetes生产部署中运行的应用程序设置资源请求和限制的猜测。它帮助工程师确定资源请求和限制的起点，同时确保应用程序正确运行。</p>
<p>要查看每个应用程序的资源请求建议，垂直窗格自动缩放器(VPA)效果很好。Goldilocks为名称空间中的每个部署创建一个VPA，然后向它们查询信息。虽然VPA可以设置资源请求，但Goldilocks中的仪表板可以方便地查看所有建议，并根据您组织的Kubernetes环境做出决策。</p>
<p>Goldilocks使用VPA中的推荐器生成推荐。事实上，金凤花开源软件完全基于底层的VPA项目，特别是推荐者。我们发现Goldilocks是设置您的资源请求和限制的一个很好的起点。但是鉴于每个环境都是不同的，Goldilocks不应该被视为针对特定用例调整应用程序的替代品。</p>
<h2>贡献给金发女孩</h2>
<p><a href="https://github.com/FairwindsOps/goldilocks" rel="noopener" target="_blank"> <span> Goldilocks是开源的，可以在GitHub </span> </a>上获得。我们继续进行大量的改进，提高其处理具有数百个名称空间和VPA对象的大型集群的能力。我们还改变了Goldilocks的部署方式，所以现在它包括了一个<a href="https://github.com/FairwindsOps/charts/tree/master/stable/vpa" rel="noopener" target="_blank"> <span> VPA子图表</span> </a>，你可以用它来安装VPA控制器和它的资源。</p>
<p>我们在SquareSpace与<a href="https://github.com/hjkatz" rel="noopener" target="_blank"> <span>哈里森·卡茨</span> </a>一起做了很多改变，这是基于他和那里的团队的宝贵反馈。我们希望不断改进我们的开源项目，并欢迎您的贡献！</p>
<p>Goldilocks也是我们的<a href="https://www.fairwinds.com/insights"> <span> Fairwinds Insights平台</span> </a>的一部分，该平台提供对您的Kubernetes集群的多集群可见性，因此您可以针对规模、可靠性、资源效率和安全性配置您的应用。Fairwinds Insights可供免费使用。可以<a href="https://www.fairwinds.com/coming-soon"> <span>在这里报名</span> </a>。</p>
<p><span class="hs-cta-wrapper" id="hs-cta-wrapper-4f92c7e1-1646-4985-9a0a-b1091903dddb"><span class="hs-cta-node hs-cta-4f92c7e1-1646-4985-9a0a-b1091903dddb" id="hs-cta-4f92c7e1-1646-4985-9a0a-b1091903dddb"><a href="https://cta-redirect.hubspot.com/cta/redirect/2184645/4f92c7e1-1646-4985-9a0a-b1091903dddb"><img class="hs-cta-img" id="hs-cta-img-4f92c7e1-1646-4985-9a0a-b1091903dddb" src="../Images/b53e4ee22b6ef19bc06a035649ea1dc6.png" alt="Free Download: Kubernetes Best Practices Whitepaper" data-original-src="https://no-cache.hubspot.com/cta/default/2184645/4f92c7e1-1646-4985-9a0a-b1091903dddb.png"/></a></span>T6】</span></p></span></div>    
</body>
</html>