<html>
<head>
<title>rbac-lookup: Reverse Lookup for Kubernetes Authorization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>RBAC-Lookup:Kubernetes授权的反向查找</h1>
<blockquote>原文：<a href="https://www.fairwinds.com/blog/rbac-lookup-reverse-lookup-for-kubernetes-authorization#2020-02-12">https://www.fairwinds.com/blog/rbac-lookup-reverse-lookup-for-kubernetes-authorization#2020-02-12</a></blockquote><div><span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p>如果您曾经使用过Kubernetes authorization，那么您可能想知道一个非常简单的问题的答案。"这个用户对这个群集有多少访问权限？"不幸的是，这个问题总是很难回答。所有相关的Kubernetes APIs都允许您列出角色绑定和集群角色绑定，但是从来没有像什么角色绑定到用户这样简单的事情。</p>

<p>考虑到这一点，我们构建了一个简单的Go CLI，<a href="https://github.com/reactiveops/rbac-lookup" data-href="https://github.com/reactiveops/rbac-lookup" rel="nofollow noopener" target="_blank"> rbac-lookup </a>，来帮助回答这个问题。要开始，您可以直接从GitHub下载最新版本，或者用Homebrew安装它:</p>
<pre><code>brew install reactiveops/tap/rbac-lookup</code></pre>
<p>在那里，您可以使用rbac-lookup来轻松查看谁可以访问哪些角色。这里有一个简单的例子:</p>
<pre><code>rbac-lookup rob

SUBJECT                   SCOPE             ROLE
rob@example.com           cluster-wide      ClusterRole/view
rob@example.com           nginx-ingress     ClusterRole/edit</code></pre>
<p>这表明“rob@example.com”除了在nginx-ingress名称空间中具有编辑权限之外，还具有集群范围的查看权限。为了获得这个结果，rbac-lookup遍历集群中的所有RoleBindings和ClusterRoleBindings，并返回主题(用户、服务帐户或组)名称与查询匹配的任何结果。</p>
<p>作为一个更完整的示例，您可以使用“wide”输出标志运行更广泛的查询:</p>
<pre><code>rbac-lookup ro -owide

SUBJECT                   SCOPE             ROLE                SOURCE
User/rob@example.com      cluster-wide      ClusterRole/view    ClusterRoleBinding/rob-cluster-view
User/rob@example.com      nginx-ingress     ClusterRole/edit    RoleBinding/rob-edit
User/ross@example.com     cluster-wide      ClusterRole/admin   ClusterRoleBinding/ross-admin
User/ron@example.com      web               ClusterRole/edit    RoleBinding/ron-edit
ServiceAccount/rops       infra             ClusterRole/admin   RoleBinding/rops-admin</code></pre>
<p>在这种情况下，我们看到有许多用户甚至一个服务帐户与“ro”查询相匹配。这个广泛的输出为我们提供了额外的信息，比如主题的类型和授予访问权限的特定源(RoleBinding或ClusterRoleBinding)。</p>
<p>希望这个工具对你和我们一样有用。你可以在<a href="https://github.com/reactiveops/rbac-lookup" data-href="https://github.com/reactiveops/rbac-lookup" rel="nofollow noopener" target="_blank"> GitHub </a>上找到这个项目。如果你有任何问题，请直接在Twitter或Kubernetes Slack (@robertjscott)上联系我。</p>
<p>如果你已经走了这么远，你可能真的很喜欢库伯内特和RBAC。如果是这样，你可能想看看我们的相关项目，<a href="https://github.com/reactiveops/rbac-manager" data-href="https://github.com/reactiveops/rbac-manager" rel="nofollow noopener" target="_blank"> rbac-manager </a>，一个旨在简化rbac管理的操作器。</p>
<p> </p>
<p><span class="hs-cta-wrapper" id="hs-cta-wrapper-08b823c4-e86d-4c16-b458-823d80c9c090"><span class="hs-cta-node hs-cta-08b823c4-e86d-4c16-b458-823d80c9c090" id="hs-cta-08b823c4-e86d-4c16-b458-823d80c9c090"><a href="https://cta-redirect.hubspot.com/cta/redirect/2184645/08b823c4-e86d-4c16-b458-823d80c9c090"><img class="hs-cta-img" id="hs-cta-img-08b823c4-e86d-4c16-b458-823d80c9c090" src="../Images/34ff13f28810d7f376985d433a5db9ed.png" alt="Download the Open Source Guide" align="middle" data-original-src="https://no-cache.hubspot.com/cta/default/2184645/08b823c4-e86d-4c16-b458-823d80c9c090.png"/></a></span>T6】</span></p></span></div>    
</body>
</html>